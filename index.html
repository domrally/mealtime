<!DOCTYPE html>
<html>

<head>
	<title>mealy</title>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="#">
</head>

<body>
	<script type="module">
    import { Context } from 'https://esm.sh/mealtime'

		const a = {
			word: "hello",
		};
		const b = {
			word: "world",
		};

		const context = new Context();
		const { target } = context;

		context.target = a;
		console.log(target.word); //> 'hello'

		context.target = b;
		console.log(target.word); //> 'world'

		(async function () {
			for await (const [key, value] of context) {
				console.log(value);
			}
		})();

		(async function () {
			target.word = "meal"; //> 'meal'
			await new Promise((r) => requestAnimationFrame(r));
			target.word = "time"; //> 'time'
		})();
	</script>
</body>

</html>